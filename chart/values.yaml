# Global settings
global:
  imageTag: latest
  imagePullPolicy: Always

# Vomeet services image config
vomeetImages:
  registry: ghcr.io
  prefix: voltade/vomeet

# Image pull secrets for private registry
imagePullSecrets: []

# ============================================================================
# Services Configuration
# ============================================================================

api-gateway:
  enabled: true
  replicaCount: 2
  image:
    repository: ""
    tag: ""
  port: 8000
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  env:
    LOG_LEVEL: INFO

admin-api:
  enabled: true
  replicaCount: 1
  image:
    repository: ""
    tag: ""
  port: 8001
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  env:
    LOG_LEVEL: INFO

bot-manager:
  enabled: true
  replicaCount: 1
  image:
    repository: ""
    tag: ""
  port: 8080
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi
  env:
    LOG_LEVEL: INFO
    ORCHESTRATOR: k8s
  serviceAccount:
    create: true
    rbac:
      create: true

transcription-collector:
  enabled: true
  replicaCount: 1
  image:
    repository: ""
    tag: ""
  port: 8000
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi
  env:
    LOG_LEVEL: INFO
    REDIS_STREAM_NAME: transcription_segments
    REDIS_CONSUMER_GROUP: collector_group
    REDIS_STREAM_READ_COUNT: "10"
    REDIS_STREAM_BLOCK_MS: "2000"
    BACKGROUND_TASK_INTERVAL: "10"
    IMMUTABILITY_THRESHOLD: "30"
    REDIS_SEGMENT_TTL: "3600"
    REDIS_CLEANUP_THRESHOLD: "86400"

google-integration:
  enabled: true
  replicaCount: 1
  image:
    repository: ""
    tag: ""
  port: 8000
  redirectUri: "https://vomeet.io/google/callback"
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  # Auto-join configuration
  autoJoin:
    enabled: false  # Set to true to enable auto-join worker
    minutesBefore: "2"  # Join meeting X minutes before start
    checkInterval: "60"  # Check for upcoming meetings every X seconds
  workerResources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi
  env:
    LOG_LEVEL: INFO

# ============================================================================
# CloudNativePG (CNPG) PostgreSQL
# ============================================================================

postgresql:
  database: vomeet
  username: vomeet
  password: ""  # Set via --set or secrets

cnpg:
  imageName: ghcr.io/cloudnative-pg/postgresql:17.4-standard-bookworm
  instances: 1
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1
      memory: 2Gi
  storage:
    storageClass: local-path
    size: 10Gi

# ============================================================================
# Dragonfly (Redis replacement)
# ============================================================================

dragonfly:
  resources:
    requests:
      cpu: 250m
      memory: 256Mi
    limits:
      cpu: 1
      memory: 512Mi

# ============================================================================
# Ingress / Gateway API
# ============================================================================

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: vomeet.example.com
      paths:
        - path: /
          pathType: Prefix
          service: api-gateway
  tls: []

httpRoute:
  enabled: false
  parentRefs:
    - name: cloudflare-https
      namespace: gateway
  hostnames:
    - vomeet.voltade.com

# ============================================================================
# External Secrets
# ============================================================================

externalSecrets:
  enabled: false
  refreshInterval: 1h
  secretStoreRef:
    name: ""
    kind: ClusterSecretStore
  data: []

# ============================================================================
# Secrets
# ============================================================================

adminApiToken: ""  # Set via --set
