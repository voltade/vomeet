{{- /*
  ExternalSecret for OnePassword integration.
  
  TODO: Add your OnePassword vault/item references to the data section.
  Example:
    data:
      - secretKey: REDIS_URL
        remoteRef:
          key: vomeet-secrets  # OnePassword item name
          property: redis_url  # Field in the item
      - secretKey: WHISPER_LIVE_URL
        remoteRef:
          key: vomeet-secrets
          property: whisper_live_url
*/}}
{{- if and .Values.externalSecrets.enabled .Values.externalSecrets.onepassword.enabled -}}
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: envs-from-onepassword
  labels:
    {{- include "vomeet-bot.labels" . | nindent 4 }}
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: {{ include "vomeet-bot.fullname" . }}-onepassword
    kind: ClusterSecretStore
  target:
    name: envs-from-onepassword
    creationPolicy: Owner
  data: []
{{- end }}
